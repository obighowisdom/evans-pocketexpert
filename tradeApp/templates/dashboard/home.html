{% extends 'dashboard/base.html' %} {% block content %}
<!DOCTYPE html>

<style>
  .crypto-prices {
    margin: 20px 0;
  }

  .price-card {
    background: linear-gradient(135deg, #f8f9fa, #ffffff);
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    text-align: center;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .price-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
  .price-icon {
    width: 40px;
    height: 40px;
    margin-bottom: 10px;
  }
  .price-header {
    font-weight: 600;
    font-size: 15px;
  }
  .price-value {
    font-size: 1.3rem;
    font-weight: bold;
    margin: 6px 0;
  }
  .price-change {
    font-size: 0.9rem;
  }
  .price-change.positive {
    color: #28a745;
  }
  .price-change.negative {
    color: #dc3545;
  }
</style>
<html lang="en">
  <body>
    <header class="header">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-2">
            <i class="fas fa-mountain text-primary fs-4"></i>
          </div>
          <div class="col-8">
            <div class="search-bar">
              <input
                type="text"
                placeholder="Search For Products"
                class="form-control"
              />
              <i class="fas fa-search search-icon"></i>
            </div>
          </div>
          <div class="col-2 text-end">
            <img
              src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 60 30'%3E%3Crect width='60' height='30' fill='%23012169'/%3E%3Cpath d='M0,0 L60,30 M60,0 L0,30' stroke='white' stroke-width='6'/%3E%3Cpath d='M0,0 L60,30 M60,0 L0,30' stroke='%23C8102E' stroke-width='2'/%3E%3Cpath d='M30,0 L30,30 M0,15 L60,15' stroke='white' stroke-width='10'/%3E%3Cpath d='M30,0 L30,30 M0,15 L60,15' stroke='%23C8102E' stroke-width='6'/%3E%3C/svg%3E"
              alt="UK Flag"
              width="24"
              height="16"
            />
          </div>
        </div>
      </div>
    </header>

    <main class="main-content">
      {% include 'dashboard/balanceCard.html' %}

      <section class="crypto-prices">
        <div class="row g-2" id="price-cards">
          <!-- Cards will be injected here by JavaScript -->
        </div>
      </section>

      <section class="buy-crypto-card">
        <div class="buy-crypto-content">
          <h3>Trade Crypto</h3>
          <p>Support BTC, USDT, ETH, etc.</p>
          <div class="payment-methods">
            <div class="payment-icon visa">VISA</div>
            <div class="payment-icon paypal">P</div>
            <div class="payment-icon bitcoin">â‚¿</div>
          </div>
        </div>
        <a href="/chart">

          <button class="arrow-btn">
            <i class="fas fa-arrow-right"></i>
          </button>
        </a>
      </section>

      <section class="action-grid">
        <div class="row g-3">
          <div class="col-3">
            <a href="/deposit" class="action-item d-block">
              <div class="action-icon">
                <i class="fas fa-plus"></i>
              </div>
              <p class="action-title">Deposit</p>
            </a>
          </div>
          <!-- <div class="col-3">
            <a href="/withdraw" class="action-item d-block">
              <div class="action-icon">
                <i class="fas fa-minus"></i>
              </div>
              <p class="action-title">Withdraw</p>
            </a>
          </div> -->
          <!-- <div class="col-3">
            <a href="#" class="action-item d-block">
              <div class="action-icon">
                <i class="fas fa-headset"></i>
              </div>
              <p class="action-title">Online service</p>
            </a>
          </div> -->
          <div class="col-3">
            <a href="/chart" class="action-item d-block position-relative">
              <span class="badge-new">NEW</span>
              <div class="action-icon">
                <i class="fas fa-coins"></i>
              </div>
              <p class="action-title">New Coins</p>
            </a>
          </div>
          <div class="col-3">
            <a href="/balance" class="action-item d-block position-relative">
              <span class="badge-hot">HOT</span>
              <div class="action-icon">
                <i class="fas fa-clock"></i>
              </div>
              <p class="action-title">Balance</p>
            </a>
          </div>
          <div class="col-3">
            <a href="/orders" class="action-item d-block">
              <div class="action-icon">
                <i class="fas fa-file-contract"></i>
              </div>
              <p class="action-title">Orders</p>
            </a>
          </div>
          <!-- <div class="col-3">
            <a href="#" class="action-item d-block">
              <div class="action-icon">
                <i class="fas fa-life-ring"></i>
              </div>
              <p class="action-title">Support</p>
            </a>
          </div> -->
          <!-- <div class="col-3">
            <a href="#" class="action-item d-block">
              <div class="action-icon">
                <i class="fas fa-ellipsis-h"></i>
              </div>
              <p class="action-title">More</p>
            </a>
          </div> -->
        </div>
      </section>

      <section class="mining-card">
        <div class="d-flex align-items-center">
          <div class="me-3">
            <i class="fas fa-pickaxe fs-2 text-warning"></i>
          </div>
          <div class="mining-content">
            <h3>Lock-up mining</h3>
            <p>One-stop financial services</p>
          </div>
        </div>
        <button class="arrow-btn">
          <i class="fas fa-arrow-right"></i>
        </button>
      </section>

      <!-- market chart -->
       <div class=" w-100">
            <div
              class="text-center rounded p-4"
              style="background-color: #9b9b9d"
            >
              <div class="white-box" style="height: 600px; width: 100%">
                <h4 style="margin-bottom: 5px" class="text-white">
                  Forex Market Fundamental Data
                </h4>
                <!-- TradingView Widget BEGIN -->

                <span id="tradingview-copyright"
                  ><a
                    ref="nofollow noopener"
                    target="_blank"
                    href="http://www.tradingview.com"
                    style="
                      color: rgb(173, 174, 176);
                      font-family: 'Trebuchet MS', Tahoma, Arial, sans-serif;
                      font-size: 13px;
                    "
                  ></a
                ></span>
                <script
                  src="https://s3.tradingview.com/external-embedding/embed-widget-forex-cross-rates.js"
                >
                  {
                              "currencies": [
                              "EUR",
                              "USD",
                              "JPY",
                              "BTC",
                              "ETH",
                              "LTC",
                              "GBP",
                              "CHF",
                              "AUD",
                              "CAD",
                              "NZD",
                              "CNY"
                              ],
                              "isTransparent": false,
                              "colorTheme": "dark",
                              "width": "100%",
                              "height": "100%",
                              "locale": "en"
                              }
                </script>
              </div>
            </div>
          </div>

      {% include 'dashboard/trade.html' %}

    </main>

    <!-- bottom -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script>
      // Assets (CoinGecko IDs)
      const assets = [
        { id: "bitcoin", label: "BTC/USDT" },
        { id: "ethereum", label: "ETH/USDT" },
        { id: "ripple", label: "XRP/USDT" },
        // { id: "cardano", label: "ADA/USDT" },
        { id: "dogecoin", label: "DOGE/USDT" },
      ];

      // Template for each card
      function createCard(icon, label, price, change) {
        const cls = change >= 0 ? "positive" : "negative";
        return `
    <div class="col-6 col-md-4 col-lg-3">
      <div class="price-card">
        <img src="${icon}" alt="${label}" class="price-icon">
        <div class="price-header">${label}</div>
        <div class="price-value">$${price}</div>
        <div class="price-change ${cls}">${change.toFixed(2)}%</div>
      </div>
    </div>
  `;
      }

      // Fetch from CoinGecko
      async function fetchData() {
        try {
          const ids = assets.map((a) => a.id).join(",");
          const res = await fetch(
            `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${ids}`
          );
          const data = await res.json();

          let html = "";
          data.forEach((coin) => {
            html += createCard(
              coin.image,
              coin.symbol.toUpperCase() + "/USDT",
              coin.current_price.toLocaleString(),
              coin.price_change_percentage_24h
            );
          });

          document.getElementById("price-cards").innerHTML = html;
        } catch (err) {
          console.error("Error fetching crypto prices:", err);
        }
      }

      // Run on load + auto-refresh every 30s
      fetchData();
      setInterval(fetchData, 30000);
    </script>
  </body>
</html>
{% endblock %}
